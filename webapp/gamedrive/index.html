<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- PWA & Mobile App Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#101010">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GameDrive">
    <link rel="apple-touch-icon" href="resources/icons/favicon.png">

    <title>GameDrive</title>
    <link rel="icon" type="image/png" href="resources/icons/favicon.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts - Inter is close to Segoe UI (Microsoft's font) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        xbox: {
                            green: '#107C10',
                            hover: '#0e6f0e',
                            light: '#25cf25',
                            dark: '#0b520b',
                        },
                        surface: {
                            DEFAULT: '#1f1f1f',
                            hover: '#2a2a2a',
                            active: '#333333',
                            base: '#121212',
                        }
                    },
                    boxShadow: {
                        'glow': '0 0 10px rgba(16, 124, 16, 0.3)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #121212;
            color: #f3f3f3;
            /* Subtle grain can add a nice texture without being noisy */
            background-image: radial-gradient(circle at top right, #1a1a1a 0%, #121212 40%);
        }
        
        /* Custom Scrollbar - Cleaner, squarer */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #121212; 
        }
        ::-webkit-scrollbar-thumb {
            background: #333; 
            border-radius: 0px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #444; 
        }

        /* Focus rings for accessibility/controller feel */
        *:focus-visible {
            outline: 2px solid #107C10;
            outline-offset: 2px;
        }

        /* Tile Hover Effect */
        .tile {
            transition: transform 0.15s cubic-bezier(0.2, 0, 0, 1), background-color 0.2s;
        }
        .tile:hover {
            transform: scale(1.01);
            background-color: #2a2a2a;
        }
        .tile:active {
            transform: scale(0.99);
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col relative">

    <!-- Loading Screen Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-[#101010] z-[100] flex flex-col items-center justify-center transition-opacity duration-500 ease-out">
        <div class="flex flex-col items-center">
            <!-- Simple Xbox-style Loading Spinner -->
            <div class="h-12 w-12 border-4 border-t-xbox-green border-r-transparent border-b-xbox-green border-l-transparent rounded-full animate-spin mb-8"></div>
            
            <h2 class="text-2xl font-bold text-white tracking-wide">GAME<span class="font-normal text-gray-400">DRIVE</span></h2>
            <p class="text-gray-500 mt-2 text-xs font-semibold tracking-widest uppercase">Initializing</p>
        </div>
    </div>

    <!-- Top Navigation Bar -->
    <nav class="fixed top-0 left-0 right-0 z-40 bg-[#181818]/95 backdrop-blur-sm border-b border-[#2a2a2a]">
        <div class="container mx-auto flex justify-between items-center h-16 px-6 lg:px-12 max-w-7xl">
            <!-- Logo -->
            <div class="flex items-center space-x-3 cursor-pointer select-none">
                <div class="h-8 w-8 bg-xbox-green rounded-full flex items-center justify-center shadow-lg shadow-green-900/20">
                    <img style="border-radius:10px;" src="resources/icons/favicon.png">
                </div>
                <h1 class="text-1g font-bold text-white tracking-tight">
                    GAMEDRIVE
                </h1>
            </div>
            
            <!-- Navigation -->
            <div class="flex items-center space-x-2">
                <div class="hidden md:flex items-center">
                    <a href="guide.html" class="px-4 py-2 text-sm font-semibold text-gray-400 hover:text-white transition-colors">Guide</a>
                    <a href="#upload-form" class="px-4 py-2 text-sm font-semibold text-gray-400 hover:text-white transition-colors">Upload</a>
                    <a href="#save-directory" class="px-4 py-2 text-sm font-semibold text-gray-400 hover:text-white transition-colors">My Files</a>
                </div>

                <div class="h-6 w-px bg-[#333] mx-2 hidden md:block"></div>

                <!-- Settings Button -->
                <button id="openSettingsBtn" class="p-2 text-gray-400 hover:text-white hover:bg-[#333] rounded transition-all duration-200" title="Settings">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.5.342 1.107.452 1.636.326z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                </button>
            </div>
        </div>
    </nav>


    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 pt-28 pb-12 max-w-5xl relative z-10">
        
        <!-- Header Section -->
        <div class="mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">My Library</h1>
            <p class="text-gray-400">Manage and backup your local game saves.</p>
        </div>

        <!-- Upload Tile -->
        <section id="upload-form" class="bg-surface rounded-lg mb-12 overflow-hidden shadow-lg border border-[#2a2a2a]">
            <div class="p-6 md:p-8">
                <div class="flex items-center space-x-3 mb-8 border-b border-[#333] pb-4">
                    <h2 class="text-xl font-semibold text-white">Upload Save File</h2>
                </div>
                
                <div class="grid gap-6 md:grid-cols-2">
                    <!-- Game Selection -->
                    <div class="md:col-span-2 space-y-2">
                        <label for="gameSearchInput" class="block text-sm font-semibold text-gray-300">Game Title</label>
                        <div class="relative">
                            <input type="text" id="gameSearchInput" placeholder="Search library..." class="w-full p-3 bg-[#121212] border border-[#333] rounded-md focus:outline-none focus:border-xbox-green focus:ring-1 focus:ring-xbox-green text-white placeholder-gray-600 transition-all duration-200" autocomplete="off">
                            <div id="gameDropdownList" class="absolute hidden z-20 w-full mt-1 bg-[#222] border border-[#333] rounded-md shadow-2xl max-h-60 overflow-y-auto">
                                <!-- Options populated by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Add New Game (Sub-section) -->
                    <div class="md:col-span-2 flex space-x-2">
                        <input type="text" id="newGameNameInput" placeholder="Or create a custom entry..." class="flex-1 p-3 bg-[#121212] border border-[#333] rounded-md focus:outline-none focus:border-xbox-green focus:ring-1 focus:ring-xbox-green text-sm text-gray-300">
                        <button id="addNewGameButton" disabled class="px-6 py-2 bg-[#2a2a2a] text-white text-sm font-semibold rounded-md hover:bg-[#333] transition-colors disabled:opacity-50 disabled:cursor-not-allowed border border-[#333]">
                            Add
                        </button>
                    </div>

                    <!-- File Selection -->
                    <div class="md:col-span-2 space-y-2 mt-2">
                        <label class="block text-sm font-semibold text-gray-300">File Source</label>
                        <input type="file" id="fileInput" class="hidden">
                        <div class="flex items-center space-x-2">
                            <button id="selectFileButton" class="px-6 py-3 bg-[#333] hover:bg-[#444] text-white font-medium rounded-md transition-all border border-transparent hover:border-gray-500">
                                Browse Device
                            </button>
                            <span id="fileNameDisplay" class="truncate flex-1 text-gray-500 bg-[#121212] p-3 rounded-md border border-[#333] select-none text-sm">No file selected</span>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="mt-8 pt-6">
                    <button id="uploadButton" disabled class="w-full py-3.5 bg-xbox-green text-white font-bold text-base uppercase tracking-wide rounded-md hover:bg-xbox-hover transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md">
                        Install to Drive
                    </button>
                </div>
            </div>
        </section>

        <!-- Directory Section -->
        <div class="flex items-center justify-between mb-4 mt-12" id="save-directory">
             <div class="flex items-center space-x-3">
                <h2 class="text-xl font-bold text-white">Installed Saves</h2>
                <span class="text-xs font-bold text-gray-500 px-2 py-0.5 border border-gray-700 rounded-sm">LOCAL STORAGE</span>
            </div>
        </div>
       
       <section id="saveList" class="flex flex-col gap-3">
            <!-- Saves rendered here by JS -->
            <!-- Example of what a card should look like (handled by JS, but styled here for reference) -->
            <!-- 
            <div class="tile bg-surface p-4 rounded-md border border-[#2a2a2a] cursor-pointer group relative">
                <h3 class="font-bold text-white">Elden Ring</h3>
                <p class="text-xs text-gray-500 mt-1">Updated 2 mins ago</p>
                <div class="absolute bottom-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
                    <button class="text-white bg-xbox-green p-2 rounded-full"><svg...></svg></button>
                </div>
            </div> 
            -->
            
            <div id="emptyState" class="md:col-span-2 flex flex-col items-center justify-center p-12 text-center bg-surface rounded-md border border-[#2a2a2a]">
                <div class="h-12 w-12 bg-[#2a2a2a] rounded-full flex items-center justify-center mb-4 text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/></svg>
                </div>
                <p class="text-base font-medium text-gray-300">No Items Found</p>
                <p class="mt-1 text-sm text-gray-500">Your collection is empty.</p>
            </div>
        </section>

    </main>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center p-4 z-50 transition-opacity">
        <div class="bg-[#1f1f1f] w-full max-w-lg rounded-lg shadow-2xl overflow-hidden ring-1 ring-[#333] transform scale-100">
            
            <!-- Modal Header -->
            <div class="px-6 py-5 border-b border-[#333] flex justify-between items-center bg-[#252525]">
                <h2 class="text-lg font-bold text-white">Settings</h2>
                <button id="closeSettingsBtn" class="p-1 rounded-sm text-gray-400 hover:text-white hover:bg-[#333] transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <div class="p-6 space-y-6">
                <!-- Mobile Navigation -->
                <div class="md:hidden grid grid-cols-2 gap-3 pb-6 border-b border-[#333]">
                     <a href="guide.html" class="p-3 text-center bg-[#2a2a2a] hover:bg-[#333] text-white text-sm font-medium rounded-md transition border border-[#333]">Guide</a>
                </div>

                <!-- Storage Stats -->
                <div>
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">System Storage</h3>
                    <div class="flex justify-between items-center p-4 bg-[#121212] rounded-md border-l-4 border-xbox-green">
                        <span class="text-gray-300 text-sm font-medium">Storage Usage</span>
                        <span id="storageUsageDisplay" class="font-mono text-base font-bold text-white">0 KB</span>
                    </div>
                </div>

                <!-- Backup/Restore -->
                <div>
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Data Management</h3>
                    <div class="space-y-3">
                        <button id="exportDataBtn" class="w-full flex items-center justify-center space-x-2 py-3 bg-[#2a2a2a] hover:bg-[#333] text-white font-medium rounded-md border border-[#333] transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                            <span>Backup All Saves</span>
                        </button>

                        <div class="space-y-4 pt-4">
                             <div class="relative">
                                <div class="absolute inset-0 flex items-center" aria-hidden="true">
                                    <div class="w-full border-t border-[#333]"></div>
                                </div>
                                <div class="relative flex justify-center">
                                    <span class="bg-[#1f1f1f] px-2 text-xs text-gray-500 uppercase">Or Import</span>
                                </div>
                            </div>

                            <div class="flex flex-col gap-2">
                                <input type="file" id="importFileInput" class="hidden" accept=".json">
                                <div class="flex space-x-2">
                                    <button id="selectImportFileBtn" class="px-4 py-2 bg-[#2a2a2a] hover:bg-[#333] text-white text-sm font-medium rounded-md border border-[#333] transition">
                                        Select File
                                    </button>
                                    <span id="importFileNameDisplay" class="flex-1 py-2 px-3 bg-[#121212] border border-[#333] rounded-md text-sm text-gray-500 truncate flex items-center">
                                        No file selected
                                    </span>
                                </div>
                                <button id="importDataBtn" disabled class="w-full py-2 mt-2 bg-transparent text-xbox-green hover:bg-xbox-green hover:text-white border border-xbox-green font-medium text-sm rounded-md transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                                    Restore Data
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Modal -->
    <div id="messageModal" class="fixed inset-0 bg-black/90 hidden items-center justify-center p-4 z-[60]">
        <div class="bg-[#1f1f1f] p-6 rounded-md shadow-2xl w-full max-w-sm border border-[#333] relative">
            <h3 id="modalTitle" class="text-xl font-bold mb-3 text-white">System Message</h3>
            <p id="modalMessage" class="text-gray-300 mb-8 text-sm leading-relaxed"></p>
            <div class="flex justify-end items-center space-x-4">
                <div id="modalSpinner" class="hidden animate-spin h-5 w-5 border-2 border-t-2 border-xbox-green border-gray-600 rounded-full"></div>
                <button id="modalOkBtn" class="px-6 py-2 bg-xbox-green hover:bg-xbox-hover text-white text-sm font-bold rounded-sm transition">OK</button>
            </div>
        </div>
    </div>
    
    <!-- Link to your main logic -->
    <script src="app.js"></script>
    
    <!-- INLINE SCRIPT FOR PREVIEW PURPOSES ONLY -->
    <script>
        // Fake loading screen logic for visual demo
        window.addEventListener('load', () => {
            const loader = document.getElementById('loading-overlay');
            if(loader) {
                setTimeout(() => {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 500);
                }, 1000);
            }
        });

        // Settings Modal Toggle Logic (Visual Demo)
        const settingsModal = document.getElementById('settingsModal');
        const openSettingsBtn = document.getElementById('openSettingsBtn');
        const closeSettingsBtn = document.getElementById('closeSettingsBtn');

        if(openSettingsBtn && settingsModal && closeSettingsBtn) {
            openSettingsBtn.addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
                settingsModal.classList.add('flex');
            });
            closeSettingsBtn.addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                settingsModal.classList.remove('flex');
            });
            // Close on backdrop click
            settingsModal.addEventListener('click', (e) => {
                if (e.target === settingsModal) {
                    settingsModal.classList.add('hidden');
                    settingsModal.classList.remove('flex');
                }
            });
        }
    </script>
</body>
</html>