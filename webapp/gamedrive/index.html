<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- PWA & Mobile App Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#09090b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="GameDrive">
    <link rel="apple-touch-icon" href="resources/icons/favicon.png">

    <title>GameDrive</title>
    <link rel="icon" type="image/png" href="resources/icons/favicon.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        zinc: {
                            850: '#1f1f22',
                            900: '#18181b',
                            950: '#09090b',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #09090b; /* Zinc 950 */
            color: #e4e4e7; /* Zinc 200 */
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #18181b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #3f3f46; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #52525b; 
        }

        /* Input autofill fix for dark mode */
        input:-webkit-autofill,
        input:-webkit-autofill:hover, 
        input:-webkit-autofill:focus, 
        input:-webkit-autofill:active{
            -webkit-box-shadow: 0 0 0 30px #27272a inset !important;
            -webkit-text-fill-color: white !important;
            transition: background-color 5000s ease-in-out 0s;
        }
        
        .glass-panel {
            background: rgba(24, 24, 27, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col relative selection:bg-indigo-500 selection:text-white">

    <!-- Background Gradients (Decorative) -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <div class="absolute top-[-10%] left-[-10%] w-96 h-96 bg-indigo-900/20 rounded-full blur-[100px]"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-96 h-96 bg-emerald-900/10 rounded-full blur-[100px]"></div>
    </div>

    <!-- Loading Screen Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-zinc-950 z-[100] flex flex-col items-center justify-center transition-opacity duration-700 ease-in-out">
        <div class="relative">
            <div class="absolute inset-0 bg-[gold] blur-xl opacity-20 rounded-full animate-pulse"></div>
            <!-- Fallback SVG logo if image fails -->
            <img src="resources/icons/favicon.png" onerror="this.style.display='none'; document.getElementById('fallback-logo-loading').style.display='block'" alt="Logo" class="relative h-20 w-20 rounded-2xl shadow-2xl mb-6">
            <svg id="fallback-logo-loading" style="display:none;" xmlns="http://www.w3.org/2000/svg" class="relative h-20 w-20 text-indigo-500 mb-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5c0-5.523 4.477-10 10-10z"/><path d="M8.5 8.5v.01"/><path d="M16 16v.01"/><path d="M12 12v.01"/><path d="M8.5 16v.01"/><path d="M16 8.5v.01"/></svg>
        </div>
        <h2 class="text-3xl font-bold text-white tracking-tight">Game<span class="text-[gold]">Drive</span></h2>
        <p class="text-gray-400 mt-2 text-sm font-medium tracking-wide animate-pulse">INITIALIZING VAULT</p>
    </div>

    <!-- Fixed Navbar -->
    <nav class="fixed top-0 left-0 right-0 z-40 border-b border-white/5 bg-zinc-950/80 backdrop-blur-xl">
        <div class="container mx-auto flex justify-between items-center h-16 px-4 lg:px-8 max-w-6xl">
            <!-- Logo -->
            <div class="flex items-center space-x-3 cursor-pointer group">
                <div class="relative flex items-center justify-center h-8 w-8 bg-gradient-to-br from-indigo-600 to-indigo-800 rounded-lg shadow-lg group-hover:shadow-indigo-500/25 transition-all duration-300">
                    <img src="resources/icons/favicon.png">
                </div>
                <h1 class="text-xl font-bold text-white tracking-tight group-hover:text-indigo-400 transition-colors">
                    Game<span class="text-gray-400 font-light">Drive</span>
                </h1>
            </div>
            
            <!-- Navigation -->
            <div class="flex items-center space-x-1 sm:space-x-6">
                <div class="hidden md:flex items-center space-x-6">
                    <a href="guide.html" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Guide</a>
                    <a href="updates.html" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Updates</a>
                    <a href="#upload-form" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Upload</a>
                    <a href="#save-directory" class="text-sm font-medium text-gray-400 hover:text-white transition-colors">Directory</a>
                </div>

                <!-- Settings Button -->
                <button id="openSettingsBtn" class="p-2 text-gray-400 hover:text-white hover:bg-white/5 rounded-lg transition-all duration-200" title="Settings">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.5.342 1.107.452 1.636.326z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                </button>
            </div>
        </div>
    </nav>


    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8 pt-28 pb-12 max-w-6xl relative z-10">
        
        <!-- Upload Section -->
        <section id="upload-form" class="glass-panel p-8 rounded-2xl shadow-2xl mb-12 relative overflow-hidden group">
            <!-- Subtle glow effect on hover -->
            <div class="absolute top-0 right-0 w-64 h-64 bg-indigo-500/10 rounded-full blur-3xl -mr-32 -mt-32 transition-opacity opacity-50 group-hover:opacity-75"></div>

            <div class="relative z-10">
                <div class="flex items-center space-x-3 mb-6">
                    <div class="h-8 w-1 bg-indigo-500 rounded-full"></div>
                    <h2 class="text-2xl font-semibold text-white tracking-tight">Upload New Save</h2>
                </div>
                
                <div class="grid gap-6 md:grid-cols-2">
                    <!-- Game Selection -->
                    <div class="md:col-span-2 space-y-2">
                        <label for="gameSearchInput" class="block text-xs font-semibold text-gray-400 uppercase tracking-wider">1. Game Name</label>
                        <div class="relative">
                            <input type="text" id="gameSearchInput" placeholder="Search for a game..." class="w-full p-4 bg-zinc-800/50 border border-zinc-700/50 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-white placeholder-gray-500 transition-all duration-200" autocomplete="off">
                            <div id="gameDropdownList" class="absolute hidden z-20 w-full mt-2 bg-zinc-900 border border-zinc-800 rounded-xl shadow-2xl max-h-60 overflow-y-auto custom-scrollbar">
                                <!-- Options populated by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Add New Game (Sub-section) -->
                    <div class="md:col-span-2 flex space-x-3">
                        <input type="text" id="newGameNameInput" placeholder="Or enter a custom game name..." class="flex-1 p-3 bg-zinc-900/50 border border-zinc-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-sm text-gray-300">
                        <button id="addNewGameButton" disabled class="px-5 py-2 bg-zinc-800 text-gray-300 text-sm font-medium rounded-lg hover:bg-zinc-700 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed border border-zinc-700">
                            Add Game
                        </button>
                    </div>

                    <!-- File Selection -->
                    <div class="md:col-span-2 space-y-2 mt-2">
                        <label class="block text-xs font-semibold text-gray-400 uppercase tracking-wider">2. Save File</label>
                        <input type="file" id="fileInput" class="hidden">
                        <div class="flex items-center space-x-3">
                            <button id="selectFileButton" class="px-6 py-3.5 bg-indigo-600 hover:bg-indigo-500 text-white font-medium rounded-xl transition-all shadow-lg shadow-indigo-500/20 active:scale-95">
                                Choose File
                            </button>
                            <span id="fileNameDisplay" class="truncate flex-1 text-gray-400 bg-zinc-900/50 p-3.5 rounded-xl border border-dashed border-zinc-700/75 select-none">No file selected</span>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="mt-8 pt-6 border-t border-white/5">
                    <button id="uploadButton" disabled class="w-full py-4 bg-gradient-to-r from-indigo-600 to-violet-600 text-white font-bold text-lg rounded-xl shadow-lg shadow-indigo-900/20 hover:shadow-indigo-500/30 hover:scale-[1.01] transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 disabled:shadow-none">
                        Upload to Local Drive
                    </button>
                </div>
            </div>
        </section>

        <!-- Directory Section -->
        <div class="flex items-center justify-between mb-6 pt-4" id="save-directory">
             <div class="flex items-center space-x-3">
                <div class="h-8 w-1 bg-emerald-500 rounded-full"></div>
                <h2 class="text-2xl font-semibold text-white tracking-tight">Directory</h2>
            </div>
            <div class="text-xs font-mono text-gray-500 bg-zinc-900 px-2 py-1 rounded border border-zinc-800">LOCAL STORAGE</div>
        </div>
       
        <section id="saveList" class="space-y-4">
            <!-- Saves rendered here by JS -->
            
            <div id="emptyState" class="hidden flex-col items-center justify-center p-16 text-center bg-zinc-900/30 rounded-2xl border-2 border-dashed border-zinc-800 hover:bg-zinc-900/50 hover:border-zinc-700 transition-colors group">
                <p class="text-lg font-medium text-gray-300">Directory is Empty</p>
                <p class="mt-2 text-sm text-gray-500 max-w-xs mx-auto">Upload a save file above to begin building your local collection.</p>
            </div>
        </section>

    </main>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden items-center justify-center p-4 z-50 transition-opacity">
        <div class="glass-panel w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden transform transition-all scale-100 ring-1 ring-white/10">
            
            <!-- Modal Header -->
            <div class="px-8 py-6 border-b border-white/5 flex justify-between items-center bg-zinc-900/40">
                <h2 class="text-xl font-bold text-white tracking-tight">Settings & Data</h2>
                <button id="closeSettingsBtn" class="p-1 rounded-md text-gray-500 hover:text-white hover:bg-white/10 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <div class="p-8 space-y-8">
                <!-- Mobile Navigation (Only visible on small screens) -->
                <div class="md:hidden grid grid-cols-2 gap-3">
                     <a href="updates.html" class="p-3 text-center bg-zinc-800 hover:bg-zinc-700 text-zinc-200 text-sm font-medium rounded-lg transition">Updates</a>
                     <a href="guide.html" class="p-3 text-center bg-zinc-800 hover:bg-zinc-700 text-zinc-200 text-sm font-medium rounded-lg transition">Guide</a>
                </div>

                <!-- Storage Stats -->
                <div>
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Storage Usage</h3>
                    <div class="flex justify-between items-center p-4 bg-zinc-950/50 rounded-xl border border-zinc-800/50">
                        <span class="text-gray-400 text-sm">Storage Used</span>
                        <span id="storageUsageDisplay" class="font-mono text-lg font-bold text-indigo-400">0 KB</span>
                    </div>
                </div>

                <!-- Backup/Restore -->
                <div>
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3">Vault Management</h3>
                    <div class="space-y-3">
                        <button id="exportDataBtn" class="w-full flex items-center justify-center space-x-2 py-3 bg-zinc-800 hover:bg-zinc-700 text-white font-medium rounded-xl border border-zinc-700 transition shadow-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                            <span>Export Backup JSON</span>
                        </button>

                        <div class="space-y-4 pt-4">
                             <!-- Separator Block -->
                             <div class="relative">
                                <div class="absolute inset-0 flex items-center" aria-hidden="true">
                                    <div class="w-full border-t border-zinc-800"></div>
                                </div>
                                <div class="relative flex justify-center">
                                    <span class="bg-zinc-900 px-2 text-xs text-gray-500">OR RESTORE</span>
                                </div>
                            </div>

                            <!-- Import Inputs -->
                            <div class="flex flex-col gap-2">
                                <input type="file" id="importFileInput" class="hidden" accept=".json">
                                <div class="flex space-x-2">
                                    <button id="selectImportFileBtn" class="px-4 py-2.5 bg-zinc-800 hover:bg-zinc-700 text-gray-300 text-sm font-medium rounded-lg border border-zinc-700 transition">
                                        Select File
                                    </button>
                                    <span id="importFileNameDisplay" class="flex-1 py-2.5 px-3 bg-zinc-950/50 border border-zinc-800 rounded-lg text-sm text-gray-500 truncate">
                                        No file selected
                                    </span>
                                </div>
                                <button id="importDataBtn" disabled class="w-full py-2.5 mt-2 bg-indigo-600/20 text-indigo-400 hover:bg-indigo-600 hover:text-white border border-indigo-500/30 hover:border-indigo-500 font-medium text-sm rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                                    Import & Overwrite Vault
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Message Modal -->
    <div id="messageModal" class="fixed inset-0 bg-black/80 hidden items-center justify-center p-4 z-[60]">
        <div class="bg-zinc-900 p-6 rounded-2xl shadow-2xl w-full max-w-sm border border-zinc-800 ring-1 ring-white/10 relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 to-purple-600"></div>
            <h3 id="modalTitle" class="text-lg font-bold mb-2 text-white">Message</h3>
            <p id="modalMessage" class="text-gray-400 mb-6 text-sm leading-relaxed"></p>
            <div class="flex justify-end items-center space-x-4">
                <div id="modalSpinner" class="hidden animate-spin h-5 w-5 border-2 border-t-2 border-indigo-500 border-zinc-700 rounded-full"></div>
                <button id="modalOkBtn" class="px-5 py-2 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-semibold rounded-lg transition shadow-lg shadow-indigo-900/20">OK</button>
            </div>
        </div>
    </div>
    
    <!-- Link to your main logic -->
    <script src="app.js"></script>
    
    <!-- INLINE SCRIPT FOR PREVIEW PURPOSES ONLY -->
    <!-- This allows you to test the visuals (modals, loading screen) in the preview window without app.js -->
    <script>
        // Fake loading screen logic for visual demo
        window.addEventListener('load', () => {
            const loader = document.getElementById('loading-overlay');
            if(loader) {
                setTimeout(() => {
                    loader.style.opacity = '0';
                    setTimeout(() => loader.style.display = 'none', 700);
                }, 1500);
            }
        });

        // Settings Modal Toggle Logic (Visual Demo)
        const settingsModal = document.getElementById('settingsModal');
        const openSettingsBtn = document.getElementById('openSettingsBtn');
        const closeSettingsBtn = document.getElementById('closeSettingsBtn');

        if(openSettingsBtn && settingsModal && closeSettingsBtn) {
            openSettingsBtn.addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
                settingsModal.classList.add('flex');
            });
            closeSettingsBtn.addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                settingsModal.classList.remove('flex');
            });
            // Close on backdrop click
            settingsModal.addEventListener('click', (e) => {
                if (e.target === settingsModal) {
                    settingsModal.classList.add('hidden');
                    settingsModal.classList.remove('flex');
                }
            });
        }
    </script>
</body>
</html>